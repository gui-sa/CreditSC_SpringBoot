-- H2 2.1.214;
;             
CREATE USER IF NOT EXISTS "PIZZA" SALT '4ba4f31e7f24930d' HASH 'c00214cc0beabbf8c99fcda6d04a7ac589b72eed1b96ac29a8d770db1c294f80' ADMIN;      
CREATE MEMORY TABLE "PUBLIC"."flyway_schema_history"(
    "installed_rank" INTEGER NOT NULL,
    "version" CHARACTER VARYING(50),
    "description" CHARACTER VARYING(200) NOT NULL,
    "type" CHARACTER VARYING(20) NOT NULL,
    "script" CHARACTER VARYING(1000) NOT NULL,
    "checksum" INTEGER,
    "installed_by" CHARACTER VARYING(100) NOT NULL,
    "installed_on" TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
    "execution_time" INTEGER NOT NULL,
    "success" BOOLEAN NOT NULL
);               
ALTER TABLE "PUBLIC"."flyway_schema_history" ADD CONSTRAINT "PUBLIC"."flyway_schema_history_pk" PRIMARY KEY("installed_rank");
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.flyway_schema_history;   
INSERT INTO "PUBLIC"."flyway_schema_history" VALUES(-1, NULL, '<< Flyway Schema History table created >>', 'TABLE', '', NULL, 'PIZZA', TIMESTAMP '2023-05-24 18:07:10.495735', 0, TRUE);      
CREATE INDEX "PUBLIC"."flyway_schema_history_s_idx" ON "PUBLIC"."flyway_schema_history"("success" NULLS FIRST);               
CREATE MEMORY TABLE "PUBLIC"."CREDIT"(
    "CREDIT_VALUE" NUMERIC(38, 2) NOT NULL,
    "DAY_FIRST_INSTALLMENT" DATE NOT NULL,
    "NUMBER_OF_INSTALLMENTS" INTEGER NOT NULL,
    "STATUS" TINYINT,
    "CUSTOMER_ID" BIGINT,
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "CREDIT_CODE" UUID NOT NULL
);              
ALTER TABLE "PUBLIC"."CREDIT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_76F" PRIMARY KEY("ID");     
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.CREDIT;  
CREATE MEMORY TABLE "PUBLIC"."CUSTOMER"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "CPF" CHARACTER VARYING(255) NOT NULL,
    "EMAIL" CHARACTER VARYING(255) NOT NULL,
    "FISRT_NAME" CHARACTER VARYING(255) NOT NULL,
    "LAST_NAME" CHARACTER VARYING(255) NOT NULL,
    "PASSWORD" CHARACTER VARYING(255) NOT NULL,
    "STREET" CHARACTER VARYING(255) NOT NULL,
    "ZIPCODE" CHARACTER VARYING(255) NOT NULL
);          
ALTER TABLE "PUBLIC"."CUSTOMER" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_52C7" PRIMARY KEY("ID");  
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.CUSTOMER;
ALTER TABLE "PUBLIC"."CREDIT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_7" CHECK("STATUS" BETWEEN 0 AND 2) NOCHECK; 
ALTER TABLE "PUBLIC"."CUSTOMER" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_52" UNIQUE("EMAIL");      
ALTER TABLE "PUBLIC"."CREDIT" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_76" UNIQUE("CREDIT_CODE");  
ALTER TABLE "PUBLIC"."CUSTOMER" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_52C" UNIQUE("ZIPCODE");   
ALTER TABLE "PUBLIC"."CUSTOMER" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_5" UNIQUE("CPF");         
ALTER TABLE "PUBLIC"."CREDIT" ADD CONSTRAINT "PUBLIC"."FKOSXY6EOXVA5HH9TSCHJWX1NF0" FOREIGN KEY("CUSTOMER_ID") REFERENCES "PUBLIC"."CUSTOMER"("ID") NOCHECK;  
